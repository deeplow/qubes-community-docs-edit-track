https://zrubi.hu/en/2017/traffic-analysis-qubes/

Excerpt:

[quote]
One of the best thing in [Qubes OS](http://zrubi.hu/qubes) that you can use special type of VMs called ProxyVM (or FirewallVM). The special thing is that your AppVMs see this as a NetVM, and the NetVMs see it as an AppVM.

Because of that You can place a ProxyVM between your AppVMs and Your NetVM. This way we can create an ideal [topology](https://blog.invisiblethings.org/2011/09/28/playing-with-qubes-networking-for-fun.html) for traffic analysis. One of the best applications for such task is [Suricata](https://suricata-ids.org/). The free and open source, mature, fast and robust network threat detection engine. The Suricata engine is capable of real time intrusion detection ([IDS](https://en.wikipedia.org/wiki/Intrusion_detection_system)), inline intrusion prevention ([IPS](https://en.wikipedia.org/wiki/Intrusion_detection_system)), network security monitoring (NSM) and offline pcap processing â€“ however this article only covers the Qubes integration of this product.
[/quote]