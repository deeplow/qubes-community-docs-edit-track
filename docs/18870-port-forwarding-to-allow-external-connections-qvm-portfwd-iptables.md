(see usage notes at bottom)

https://gist.github.com/fepitre/941d7161ae1150d90e15f778027e3248